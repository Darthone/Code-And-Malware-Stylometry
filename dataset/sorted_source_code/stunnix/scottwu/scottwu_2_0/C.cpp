
#include <iostream>
#include <iomanip>
#include <fstream>
#include <algorithm>
#include <vector>
#include <map>
#include <string>
using namespace std;typedef long long ReplacementFor_ll;const int 
ReplacementFor_MAXN=(0x364+2199-0xb8d);ifstream fin("\x43\x2e\x69\x6e");ofstream
 fout("\x43\x2e\x6f\x75\x74");int ReplacementFor_N,Q;ReplacementFor_ll 
ReplacementFor_mdist[ReplacementFor_MAXN],ReplacementFor_spd[ReplacementFor_MAXN
];ReplacementFor_ll ReplacementFor_fdist[ReplacementFor_MAXN][
ReplacementFor_MAXN];double ReplacementFor_rdist[ReplacementFor_MAXN][
ReplacementFor_MAXN];void ReplacementFor_run(){fin>>ReplacementFor_N>>Q;for(int 
ReplacementFor_i=(0x36b+4184-0x13c3);ReplacementFor_i<ReplacementFor_N;
ReplacementFor_i++)fin>>ReplacementFor_mdist[ReplacementFor_i]>>
ReplacementFor_spd[ReplacementFor_i];for(int ReplacementFor_i=
(0xfa9+3830-0x1e9f);ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++)for(int
 ReplacementFor_j=(0xad5+2244-0x1399);ReplacementFor_j<ReplacementFor_N;
ReplacementFor_j++){fin>>ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j
];if(ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j]==-
(0xef+3246-0xd9c))ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j]=1e12;
if(ReplacementFor_i==ReplacementFor_j)ReplacementFor_fdist[ReplacementFor_i][
ReplacementFor_j]=(0x1903+1829-0x2028);}for(int ReplacementFor_k=
(0x17db+2042-0x1fd5);ReplacementFor_k<ReplacementFor_N;ReplacementFor_k++)for(
int ReplacementFor_i=(0x15e5+1112-0x1a3d);ReplacementFor_i<ReplacementFor_N;
ReplacementFor_i++)for(int ReplacementFor_j=(0x2d5+1334-0x80b);ReplacementFor_j<
ReplacementFor_N;ReplacementFor_j++){ReplacementFor_fdist[ReplacementFor_i][
ReplacementFor_j]=min(ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j],
ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_k]+ReplacementFor_fdist[
ReplacementFor_k][ReplacementFor_j]);}for(int ReplacementFor_i=
(0x1902+1719-0x1fb9);ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++){for(
int ReplacementFor_j=(0x1a41+2191-0x22d0);ReplacementFor_j<ReplacementFor_N;
ReplacementFor_j++){if(ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j]>
ReplacementFor_mdist[ReplacementFor_i])ReplacementFor_rdist[ReplacementFor_i][
ReplacementFor_j]=1e12;else ReplacementFor_rdist[ReplacementFor_i][
ReplacementFor_j]=ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j]/((
double)ReplacementFor_spd[ReplacementFor_i]+0.0);}}for(int ReplacementFor_k=
(0x18aa+1352-0x1df2);ReplacementFor_k<ReplacementFor_N;ReplacementFor_k++)for(
int ReplacementFor_i=(0x22d+6535-0x1bb4);ReplacementFor_i<ReplacementFor_N;
ReplacementFor_i++)for(int ReplacementFor_j=(0x5b0+3643-0x13eb);ReplacementFor_j
<ReplacementFor_N;ReplacementFor_j++){ReplacementFor_rdist[ReplacementFor_i][
ReplacementFor_j]=min(ReplacementFor_rdist[ReplacementFor_i][ReplacementFor_j],
ReplacementFor_rdist[ReplacementFor_i][ReplacementFor_k]+ReplacementFor_rdist[
ReplacementFor_k][ReplacementFor_j]);}for(int ReplacementFor_i=
(0x95c+5174-0x1d92);ReplacementFor_i<Q;ReplacementFor_i++){if(ReplacementFor_i)
fout<<"\x20";int s,ReplacementFor_e;fin>>s>>ReplacementFor_e;s--,
ReplacementFor_e--;fout<<ReplacementFor_rdist[s][ReplacementFor_e];}}int main(){
fout<<fixed<<setprecision((0x67f+3536-0x1448));int ReplacementFor_T;fin>>
ReplacementFor_T;for(int ReplacementFor_i=(0xd37+4049-0x1d07);ReplacementFor_i<=
ReplacementFor_T;ReplacementFor_i++){fout<<"\x43\x61\x73\x65\x20\x23"<<
ReplacementFor_i<<"\x3a\x20";ReplacementFor_run();fout<<"\n";}}
