
#include <iostream>
#include <iomanip>
#include <fstream>
#include <algorithm>
#include <vector>
#include <map>
#include <string>
using namespace std;typedef long long ReplacementFor_ll;const int 
ReplacementFor_MAXN=(0x199+6051-0x18ce);ifstream fin("\x43\x2e\x69\x6e");
ofstream fout("\x43\x2e\x6f\x75\x74");int ReplacementFor_N,Q;ReplacementFor_ll 
ReplacementFor_mdist[ReplacementFor_MAXN],ReplacementFor_spd[ReplacementFor_MAXN
];ReplacementFor_ll ReplacementFor_fdist[ReplacementFor_MAXN][
ReplacementFor_MAXN];double ReplacementFor_rdist[ReplacementFor_MAXN][
ReplacementFor_MAXN];void ReplacementFor_run(){fin>>ReplacementFor_N>>Q;for(int 
ReplacementFor_i=(0x1983+1343-0x1ec2);ReplacementFor_i<ReplacementFor_N;
ReplacementFor_i++)fin>>ReplacementFor_mdist[ReplacementFor_i]>>
ReplacementFor_spd[ReplacementFor_i];for(int ReplacementFor_i=
(0x19dc+1600-0x201c);ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++)for(
int ReplacementFor_j=(0x260c+32-0x262c);ReplacementFor_j<ReplacementFor_N;
ReplacementFor_j++){fin>>ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j
];if(ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j]==-
(0x78a+3307-0x1474))ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j]=
1e12;if(ReplacementFor_i==ReplacementFor_j)ReplacementFor_fdist[ReplacementFor_i
][ReplacementFor_j]=(0x90a+4404-0x1a3e);}for(int ReplacementFor_k=
(0x4f6+6497-0x1e57);ReplacementFor_k<ReplacementFor_N;ReplacementFor_k++)for(int
 ReplacementFor_i=(0x160a+2777-0x20e3);ReplacementFor_i<ReplacementFor_N;
ReplacementFor_i++)for(int ReplacementFor_j=(0xa+5721-0x1663);ReplacementFor_j<
ReplacementFor_N;ReplacementFor_j++){ReplacementFor_fdist[ReplacementFor_i][
ReplacementFor_j]=min(ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j],
ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_k]+ReplacementFor_fdist[
ReplacementFor_k][ReplacementFor_j]);}for(int ReplacementFor_i=
(0x2a9+2794-0xd93);ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++){for(int
 ReplacementFor_j=(0xb5b+1332-0x108f);ReplacementFor_j<ReplacementFor_N;
ReplacementFor_j++){if(ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j]>
ReplacementFor_mdist[ReplacementFor_i])ReplacementFor_rdist[ReplacementFor_i][
ReplacementFor_j]=1e12;else ReplacementFor_rdist[ReplacementFor_i][
ReplacementFor_j]=ReplacementFor_fdist[ReplacementFor_i][ReplacementFor_j]/((
double)ReplacementFor_spd[ReplacementFor_i]+0.0);}}for(int ReplacementFor_k=
(0x378+7318-0x200e);ReplacementFor_k<ReplacementFor_N;ReplacementFor_k++)for(int
 ReplacementFor_i=(0x92f+6869-0x2404);ReplacementFor_i<ReplacementFor_N;
ReplacementFor_i++)for(int ReplacementFor_j=(0xdd3+984-0x11ab);ReplacementFor_j<
ReplacementFor_N;ReplacementFor_j++){ReplacementFor_rdist[ReplacementFor_i][
ReplacementFor_j]=min(ReplacementFor_rdist[ReplacementFor_i][ReplacementFor_j],
ReplacementFor_rdist[ReplacementFor_i][ReplacementFor_k]+ReplacementFor_rdist[
ReplacementFor_k][ReplacementFor_j]);}for(int ReplacementFor_i=
(0x5a9+7023-0x2118);ReplacementFor_i<Q;ReplacementFor_i++){if(ReplacementFor_i)
fout<<"\x20";int s,ReplacementFor_e;fin>>s>>ReplacementFor_e;s--,
ReplacementFor_e--;fout<<ReplacementFor_rdist[s][ReplacementFor_e];}}int main(){
fout<<fixed<<setprecision((0x105d+400-0x11e6));int ReplacementFor_T;fin>>
ReplacementFor_T;for(int ReplacementFor_i=(0x1245+1196-0x16f0);ReplacementFor_i
<=ReplacementFor_T;ReplacementFor_i++){fout<<"\x43\x61\x73\x65\x20\x23"<<
ReplacementFor_i<<"\x3a\x20";ReplacementFor_run();fout<<"\n";}}
