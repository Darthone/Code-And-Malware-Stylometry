
#include <algorithm>
#include <cstdio>
#include <vector>
using namespace std;typedef int64_t ReplacementFor_i64;int main(){
ReplacementFor_i64 ReplacementFor_T;scanf("\x25\x6c\x6c\x64",&ReplacementFor_T);
for(ReplacementFor_i64 ReplacementFor_zz=(0xbe6+4912-0x1f15);ReplacementFor_zz<=
ReplacementFor_T;ReplacementFor_zz++){ReplacementFor_i64 ReplacementFor_N,Q;
scanf("\x25\x6c\x6c\x64\x20\x25\x6c\x6c\x64",&ReplacementFor_N,&Q);vector<
ReplacementFor_i64>ReplacementFor_E(ReplacementFor_N),S(ReplacementFor_N);for(
ReplacementFor_i64 ReplacementFor_i=(0x9c0+992-0xda0);ReplacementFor_i<
ReplacementFor_N;ReplacementFor_i++){scanf(
"\x25\x6c\x6c\x64\x20\x25\x6c\x6c\x64",&ReplacementFor_E[ReplacementFor_i],&S[
ReplacementFor_i]);}vector<vector<ReplacementFor_i64>>ReplacementFor_D(
ReplacementFor_N,vector<ReplacementFor_i64>(ReplacementFor_N));for(
ReplacementFor_i64 ReplacementFor_i=(0x497+2086-0xcbd);ReplacementFor_i<
ReplacementFor_N;ReplacementFor_i++){for(ReplacementFor_i64 ReplacementFor_j=
(0x19a+4517-0x133f);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){scanf(
"\x25\x6c\x6c\x64",&ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]);if(
ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]==-(0x3fc+2878-0xf39)){if(
ReplacementFor_i!=ReplacementFor_j){ReplacementFor_D[ReplacementFor_i][
ReplacementFor_j]=1e16;}else{ReplacementFor_D[ReplacementFor_i][ReplacementFor_j
]=(0x16fb+1583-0x1d2a);}}}}for(ReplacementFor_i64 ReplacementFor_k=
(0x1cf+3722-0x1059);ReplacementFor_k<ReplacementFor_N;ReplacementFor_k++)for(
ReplacementFor_i64 ReplacementFor_i=(0x538+790-0x84e);ReplacementFor_i<
ReplacementFor_N;ReplacementFor_i++)for(ReplacementFor_i64 ReplacementFor_j=
(0x722+4799-0x19e1);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++)
ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]=min(ReplacementFor_D[
ReplacementFor_i][ReplacementFor_j],ReplacementFor_D[ReplacementFor_i][
ReplacementFor_k]+ReplacementFor_D[ReplacementFor_k][ReplacementFor_j]);vector<
vector<double>>ReplacementFor_T(ReplacementFor_N,vector<double>(ReplacementFor_N
));for(ReplacementFor_i64 ReplacementFor_i=(0x3ab+3512-0x1163);ReplacementFor_i<
ReplacementFor_N;ReplacementFor_i++){for(ReplacementFor_i64 ReplacementFor_j=
(0x1806+1824-0x1f26);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){
ReplacementFor_T[ReplacementFor_i][ReplacementFor_j]=ReplacementFor_E[
ReplacementFor_i]>=ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]?
static_cast<double>(ReplacementFor_D[ReplacementFor_i][ReplacementFor_j])/S[
ReplacementFor_i]:1e16;}}for(ReplacementFor_i64 ReplacementFor_k=
(0x1391+4851-0x2684);ReplacementFor_k<ReplacementFor_N;ReplacementFor_k++)for(
ReplacementFor_i64 ReplacementFor_i=(0x35a+8649-0x2523);ReplacementFor_i<
ReplacementFor_N;ReplacementFor_i++)for(ReplacementFor_i64 ReplacementFor_j=
(0x1f8+7178-0x1e02);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++)
ReplacementFor_T[ReplacementFor_i][ReplacementFor_j]=min(ReplacementFor_T[
ReplacementFor_i][ReplacementFor_j],ReplacementFor_T[ReplacementFor_i][
ReplacementFor_k]+ReplacementFor_T[ReplacementFor_k][ReplacementFor_j]);printf(
"\x43\x61\x73\x65\x20\x23\x25\x6c\x6c\x64\x3a",ReplacementFor_zz);for(
ReplacementFor_i64 ReplacementFor_i=(0x8f0+7666-0x26e2);ReplacementFor_i<Q;
ReplacementFor_i++){ReplacementFor_i64 ReplacementFor_u,ReplacementFor_v;scanf(
"\x25\x6c\x6c\x64\x20\x25\x6c\x6c\x64",&ReplacementFor_u,&ReplacementFor_v);
ReplacementFor_u--;ReplacementFor_v--;printf("\x20\x25\x2e\x30\x39\x66",
ReplacementFor_T[ReplacementFor_u][ReplacementFor_v]);}printf("\n");}}
