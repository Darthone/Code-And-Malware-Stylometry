
#include <bits/stdc++.h>
using namespace std;const int ReplacementFor_maxN=(0xab6+53-0xa87)+
(0x4d5+3778-0x1333);typedef long double ReplacementFor_ld;typedef long long 
ReplacementFor_ll;const ReplacementFor_ll ReplacementFor_inf=1e17;struct 
ReplacementFor_Problem{ReplacementFor_ll ReplacementFor_d[ReplacementFor_maxN];
ReplacementFor_ll s[ReplacementFor_maxN];ReplacementFor_ll ReplacementFor_mat[
ReplacementFor_maxN][ReplacementFor_maxN];ReplacementFor_ld ReplacementFor_c[
ReplacementFor_maxN][ReplacementFor_maxN];void solve(){int ReplacementFor_n,q;
cin>>ReplacementFor_n>>q;for(int ReplacementFor_i=(0x1641+2507-0x200c);
ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++)cin>>ReplacementFor_d[
ReplacementFor_i]>>s[ReplacementFor_i];for(int ReplacementFor_i=
(0x42d+8525-0x257a);ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++)for(int
 ReplacementFor_j=(0x7a6+5754-0x1e20);ReplacementFor_j<ReplacementFor_n;
ReplacementFor_j++){cin>>ReplacementFor_mat[ReplacementFor_i][ReplacementFor_j];
if(ReplacementFor_mat[ReplacementFor_i][ReplacementFor_j]==-(0x385+3868-0x12a0))
ReplacementFor_mat[ReplacementFor_i][ReplacementFor_j]=ReplacementFor_inf;}for(
int ReplacementFor_k=(0x4df+365-0x64c);ReplacementFor_k<ReplacementFor_n;
ReplacementFor_k++)for(int ReplacementFor_i=(0x17df+381-0x195c);ReplacementFor_i
<ReplacementFor_n;ReplacementFor_i++)for(int ReplacementFor_j=
(0x402+5990-0x1b68);ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++)
ReplacementFor_mat[ReplacementFor_i][ReplacementFor_j]=min(ReplacementFor_mat[
ReplacementFor_i][ReplacementFor_j],ReplacementFor_mat[ReplacementFor_i][
ReplacementFor_k]+ReplacementFor_mat[ReplacementFor_k][ReplacementFor_j]);for(
int ReplacementFor_i=(0x563+6928-0x2073);ReplacementFor_i<ReplacementFor_n;
ReplacementFor_i++)for(int ReplacementFor_j=(0x132f+1959-0x1ad6);
ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++)if(ReplacementFor_mat[
ReplacementFor_i][ReplacementFor_j]<=ReplacementFor_d[ReplacementFor_i])
ReplacementFor_c[ReplacementFor_i][ReplacementFor_j]=ReplacementFor_mat[
ReplacementFor_i][ReplacementFor_j]/ReplacementFor_ld(s[ReplacementFor_i]);else 
ReplacementFor_c[ReplacementFor_i][ReplacementFor_j]=ReplacementFor_inf;for(int 
ReplacementFor_k=(0x5a3+2150-0xe09);ReplacementFor_k<ReplacementFor_n;
ReplacementFor_k++)for(int ReplacementFor_i=(0x2b5+1100-0x701);ReplacementFor_i<
ReplacementFor_n;ReplacementFor_i++)for(int ReplacementFor_j=(0x851+4603-0x1a4c)
;ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++)ReplacementFor_c[
ReplacementFor_i][ReplacementFor_j]=min(ReplacementFor_c[ReplacementFor_i][
ReplacementFor_j],ReplacementFor_c[ReplacementFor_i][ReplacementFor_k]+
ReplacementFor_c[ReplacementFor_k][ReplacementFor_j]);for(int ReplacementFor_i=
(0x566+328-0x6ae);ReplacementFor_i<q;ReplacementFor_i++){int ReplacementFor_u,
ReplacementFor_v;cin>>ReplacementFor_u>>ReplacementFor_v;ReplacementFor_u--;
ReplacementFor_v--;cout<<ReplacementFor_c[ReplacementFor_u][ReplacementFor_v]<<
"\x20";}cout<<endl;}};int main(){cout<<fixed<<setprecision((0x3a6+4803-0x1655));
int ReplacementFor_t;cin>>ReplacementFor_t;for(int ReplacementFor_i=
(0x1357+590-0x15a4);ReplacementFor_i<=ReplacementFor_t;ReplacementFor_i++){cout
<<"\x43\x61\x73\x65\x20\x23"<<ReplacementFor_i<<"\x3a\x20";
ReplacementFor_Problem ReplacementFor_x;ReplacementFor_x.solve();}}
