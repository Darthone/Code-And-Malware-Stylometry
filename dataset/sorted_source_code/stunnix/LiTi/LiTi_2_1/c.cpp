
#include <bits/stdc++.h>
using namespace std;const int ReplacementFor_maxN=(0x1cd6+2151-0x24d9)+
(0x11d8+5206-0x25ca);typedef long double ReplacementFor_ld;typedef long long 
ReplacementFor_ll;const ReplacementFor_ll ReplacementFor_inf=1e17;struct 
ReplacementFor_Problem{ReplacementFor_ll ReplacementFor_d[ReplacementFor_maxN];
ReplacementFor_ll s[ReplacementFor_maxN];ReplacementFor_ll ReplacementFor_mat[
ReplacementFor_maxN][ReplacementFor_maxN];ReplacementFor_ld ReplacementFor_c[
ReplacementFor_maxN][ReplacementFor_maxN];void solve(){int ReplacementFor_n,q;
cin>>ReplacementFor_n>>q;for(int ReplacementFor_i=(0xafb+6983-0x2642);
ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++)cin>>ReplacementFor_d[
ReplacementFor_i]>>s[ReplacementFor_i];for(int ReplacementFor_i=
(0x5e6+6568-0x1f8e);ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++)for(int
 ReplacementFor_j=(0x1d8+893-0x555);ReplacementFor_j<ReplacementFor_n;
ReplacementFor_j++){cin>>ReplacementFor_mat[ReplacementFor_i][ReplacementFor_j];
if(ReplacementFor_mat[ReplacementFor_i][ReplacementFor_j]==-(0x754+7401-0x243c))
ReplacementFor_mat[ReplacementFor_i][ReplacementFor_j]=ReplacementFor_inf;}for(
int ReplacementFor_k=(0x1b79+1283-0x207c);ReplacementFor_k<ReplacementFor_n;
ReplacementFor_k++)for(int ReplacementFor_i=(0x799+2116-0xfdd);ReplacementFor_i<
ReplacementFor_n;ReplacementFor_i++)for(int ReplacementFor_j=(0x263+7818-0x20ed)
;ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++)ReplacementFor_mat[
ReplacementFor_i][ReplacementFor_j]=min(ReplacementFor_mat[ReplacementFor_i][
ReplacementFor_j],ReplacementFor_mat[ReplacementFor_i][ReplacementFor_k]+
ReplacementFor_mat[ReplacementFor_k][ReplacementFor_j]);for(int ReplacementFor_i
=(0x1148+5548-0x26f4);ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++)for(
int ReplacementFor_j=(0xffc+227-0x10df);ReplacementFor_j<ReplacementFor_n;
ReplacementFor_j++)if(ReplacementFor_mat[ReplacementFor_i][ReplacementFor_j]<=
ReplacementFor_d[ReplacementFor_i])ReplacementFor_c[ReplacementFor_i][
ReplacementFor_j]=ReplacementFor_mat[ReplacementFor_i][ReplacementFor_j]/
ReplacementFor_ld(s[ReplacementFor_i]);else ReplacementFor_c[ReplacementFor_i][
ReplacementFor_j]=ReplacementFor_inf;for(int ReplacementFor_k=
(0xcc7+6146-0x24c9);ReplacementFor_k<ReplacementFor_n;ReplacementFor_k++)for(int
 ReplacementFor_i=(0x1523+2798-0x2011);ReplacementFor_i<ReplacementFor_n;
ReplacementFor_i++)for(int ReplacementFor_j=(0x960+7518-0x26be);ReplacementFor_j
<ReplacementFor_n;ReplacementFor_j++)ReplacementFor_c[ReplacementFor_i][
ReplacementFor_j]=min(ReplacementFor_c[ReplacementFor_i][ReplacementFor_j],
ReplacementFor_c[ReplacementFor_i][ReplacementFor_k]+ReplacementFor_c[
ReplacementFor_k][ReplacementFor_j]);for(int ReplacementFor_i=
(0x3bd+7021-0x1f2a);ReplacementFor_i<q;ReplacementFor_i++){int ReplacementFor_u,
ReplacementFor_v;cin>>ReplacementFor_u>>ReplacementFor_v;ReplacementFor_u--;
ReplacementFor_v--;cout<<ReplacementFor_c[ReplacementFor_u][ReplacementFor_v]<<
"\x20";}cout<<endl;}};int main(){cout<<fixed<<setprecision((0xa4a+3382-0x176c));
int ReplacementFor_t;cin>>ReplacementFor_t;for(int ReplacementFor_i=
(0xcb3+16-0xcc2);ReplacementFor_i<=ReplacementFor_t;ReplacementFor_i++){cout<<
"\x43\x61\x73\x65\x20\x23"<<ReplacementFor_i<<"\x3a\x20";ReplacementFor_Problem 
ReplacementFor_x;ReplacementFor_x.solve();}}
