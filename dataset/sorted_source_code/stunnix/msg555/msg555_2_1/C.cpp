
#include <iostream>
#include <vector>
#include <algorithm>
#include <map>
#include <set>
#include <queue>
#include <cstdio>
using namespace std;
#define ReplacementFor_MAXN (0x13b3+1711-0x19f4)
#define ReplacementFor_INF 0x3FFFFFFFFFFFFFFFLL;
int ReplacementFor_HE[ReplacementFor_MAXN];int ReplacementFor_HS[
ReplacementFor_MAXN];long long ReplacementFor_D[ReplacementFor_MAXN][
ReplacementFor_MAXN];double ReplacementFor_D2[ReplacementFor_MAXN][
ReplacementFor_MAXN];int main(){int ReplacementFor_T;cin>>ReplacementFor_T;for(
int ReplacementFor_t=(0xdf2+377-0xf6a);ReplacementFor_t<=ReplacementFor_T;
ReplacementFor_t++){int ReplacementFor_N,Q;cin>>ReplacementFor_N>>Q;for(int 
ReplacementFor_i=(0x13f9+4636-0x2615);ReplacementFor_i<ReplacementFor_N;
ReplacementFor_i++){cin>>ReplacementFor_HE[ReplacementFor_i]>>ReplacementFor_HS[
ReplacementFor_i];}for(int ReplacementFor_i=(0x86c+71-0x8b3);ReplacementFor_i<
ReplacementFor_N;ReplacementFor_i++){for(int ReplacementFor_j=
(0x3aa+3450-0x1124);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){cin>>
ReplacementFor_D[ReplacementFor_i][ReplacementFor_j];if(ReplacementFor_i==
ReplacementFor_j){ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]=
(0x764+1043-0xb77);}else if(ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]
==-(0x12db+4307-0x23ad)){ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]=
ReplacementFor_INF;}}}for(int ReplacementFor_k=(0xe1b+3985-0x1dac);
ReplacementFor_k<ReplacementFor_N;ReplacementFor_k++){for(int ReplacementFor_i=
(0x17ea+3059-0x23dd);ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++){for(
int ReplacementFor_j=(0x1932+2197-0x21c7);ReplacementFor_j<ReplacementFor_N;
ReplacementFor_j++){ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]=min(
ReplacementFor_D[ReplacementFor_i][ReplacementFor_j],ReplacementFor_D[
ReplacementFor_i][ReplacementFor_k]+ReplacementFor_D[ReplacementFor_k][
ReplacementFor_j]);}}}for(int ReplacementFor_i=(0x10f8+2460-0x1a94);
ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++){for(int ReplacementFor_j=
(0x10f8+716-0x13c4);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){if(
ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]<=ReplacementFor_HE[
ReplacementFor_i]){ReplacementFor_D2[ReplacementFor_i][ReplacementFor_j]=1.0*
ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]/ReplacementFor_HS[
ReplacementFor_i];}else{ReplacementFor_D2[ReplacementFor_i][ReplacementFor_j]=
1e300;}}}for(int ReplacementFor_k=(0x2359+194-0x241b);ReplacementFor_k<
ReplacementFor_N;ReplacementFor_k++){for(int ReplacementFor_i=
(0x1c41+218-0x1d1b);ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++){for(
int ReplacementFor_j=(0x48d+7928-0x2385);ReplacementFor_j<ReplacementFor_N;
ReplacementFor_j++){ReplacementFor_D2[ReplacementFor_i][ReplacementFor_j]=min(
ReplacementFor_D2[ReplacementFor_i][ReplacementFor_j],ReplacementFor_D2[
ReplacementFor_i][ReplacementFor_k]+ReplacementFor_D2[ReplacementFor_k][
ReplacementFor_j]);}}}cout<<"\x43\x61\x73\x65\x20\x23"<<ReplacementFor_t<<"\x3a"
;for(int ReplacementFor_i=(0xdff+4977-0x2170);ReplacementFor_i<Q;
ReplacementFor_i++){int ReplacementFor_u,ReplacementFor_v;cin>>ReplacementFor_u
>>ReplacementFor_v;ReplacementFor_u--;ReplacementFor_v--;printf(
"\x20\x25\x2e\x39\x66",ReplacementFor_D2[ReplacementFor_u][ReplacementFor_v]);}
cout<<endl;}return(0x14d8+3444-0x224c);}
