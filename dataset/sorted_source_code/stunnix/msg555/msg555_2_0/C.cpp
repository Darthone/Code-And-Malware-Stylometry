
#include <iostream>
#include <vector>
#include <algorithm>
#include <map>
#include <set>
#include <queue>
#include <cstdio>
using namespace std;
#define ReplacementFor_MAXN (0x31a+4876-0x15b8)
#define ReplacementFor_INF 0x3FFFFFFFFFFFFFFFLL;
int ReplacementFor_HE[ReplacementFor_MAXN];int ReplacementFor_HS[
ReplacementFor_MAXN];long long ReplacementFor_D[ReplacementFor_MAXN][
ReplacementFor_MAXN];double ReplacementFor_D2[ReplacementFor_MAXN][
ReplacementFor_MAXN];int main(){int ReplacementFor_T;cin>>ReplacementFor_T;for(
int ReplacementFor_t=(0x8a2+7774-0x26ff);ReplacementFor_t<=ReplacementFor_T;
ReplacementFor_t++){int ReplacementFor_N,Q;cin>>ReplacementFor_N>>Q;for(int 
ReplacementFor_i=(0x906+7157-0x24fb);ReplacementFor_i<ReplacementFor_N;
ReplacementFor_i++){cin>>ReplacementFor_HE[ReplacementFor_i]>>ReplacementFor_HS[
ReplacementFor_i];}for(int ReplacementFor_i=(0xa17+4107-0x1a22);ReplacementFor_i
<ReplacementFor_N;ReplacementFor_i++){for(int ReplacementFor_j=
(0x6ca+4091-0x16c5);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){cin>>
ReplacementFor_D[ReplacementFor_i][ReplacementFor_j];if(ReplacementFor_i==
ReplacementFor_j){ReplacementFor_D[ReplacementFor_i][ReplacementFor_j]=
(0x1166+4363-0x2271);}else if(ReplacementFor_D[ReplacementFor_i][
ReplacementFor_j]==-(0xb1d+3162-0x1776)){ReplacementFor_D[ReplacementFor_i][
ReplacementFor_j]=ReplacementFor_INF;}}}for(int ReplacementFor_k=
(0x1639+470-0x180f);ReplacementFor_k<ReplacementFor_N;ReplacementFor_k++){for(
int ReplacementFor_i=(0x2007+1031-0x240e);ReplacementFor_i<ReplacementFor_N;
ReplacementFor_i++){for(int ReplacementFor_j=(0xea9+5405-0x23c6);
ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){ReplacementFor_D[
ReplacementFor_i][ReplacementFor_j]=min(ReplacementFor_D[ReplacementFor_i][
ReplacementFor_j],ReplacementFor_D[ReplacementFor_i][ReplacementFor_k]+
ReplacementFor_D[ReplacementFor_k][ReplacementFor_j]);}}}for(int 
ReplacementFor_i=(0x293+2413-0xc00);ReplacementFor_i<ReplacementFor_N;
ReplacementFor_i++){for(int ReplacementFor_j=(0x1589+427-0x1734);
ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){if(ReplacementFor_D[
ReplacementFor_i][ReplacementFor_j]<=ReplacementFor_HE[ReplacementFor_i]){
ReplacementFor_D2[ReplacementFor_i][ReplacementFor_j]=1.0*ReplacementFor_D[
ReplacementFor_i][ReplacementFor_j]/ReplacementFor_HS[ReplacementFor_i];}else{
ReplacementFor_D2[ReplacementFor_i][ReplacementFor_j]=1e300;}}}for(int 
ReplacementFor_k=(0x225b+246-0x2351);ReplacementFor_k<ReplacementFor_N;
ReplacementFor_k++){for(int ReplacementFor_i=(0x8bd+2919-0x1424);
ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++){for(int ReplacementFor_j=
(0xb4f+2357-0x1484);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){
ReplacementFor_D2[ReplacementFor_i][ReplacementFor_j]=min(ReplacementFor_D2[
ReplacementFor_i][ReplacementFor_j],ReplacementFor_D2[ReplacementFor_i][
ReplacementFor_k]+ReplacementFor_D2[ReplacementFor_k][ReplacementFor_j]);}}}cout
<<"\x43\x61\x73\x65\x20\x23"<<ReplacementFor_t<<"\x3a";for(int ReplacementFor_i=
(0x17ba+2300-0x20b6);ReplacementFor_i<Q;ReplacementFor_i++){int ReplacementFor_u
,ReplacementFor_v;cin>>ReplacementFor_u>>ReplacementFor_v;ReplacementFor_u--;
ReplacementFor_v--;printf("\x20\x25\x2e\x39\x66",ReplacementFor_D2[
ReplacementFor_u][ReplacementFor_v]);}cout<<endl;}return(0x177a+3585-0x257b);}
