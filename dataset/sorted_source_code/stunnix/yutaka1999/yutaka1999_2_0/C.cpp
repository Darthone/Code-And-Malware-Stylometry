
#include <cstdio>
#include <cstdlib>
#include <algorithm>
#include <vector>
#include <cstring>
#include <queue>
#include <map>
#include <set>
#include <functional>
#include <cmath>
#include <string>
#define SIZE (0xbbb+3279-0x1821)
#define ReplacementFor_INF 100000000000000000LL
using namespace std;typedef long long int ReplacementFor_ll;typedef pair<int,int
>ReplacementFor_P;ReplacementFor_ll ReplacementFor_dist[SIZE][SIZE];double 
ReplacementFor_dp[SIZE][SIZE];ReplacementFor_ll ReplacementFor_E[SIZE],S[SIZE];
int main(){int ReplacementFor_T;scanf("\x25\x64",&ReplacementFor_T);for(int 
ReplacementFor_t=(0x681+1154-0xb02);ReplacementFor_t<=ReplacementFor_T;
ReplacementFor_t++){printf("\x43\x61\x73\x65\x20\x23\x25\x64\x3a\x20",
ReplacementFor_t);int ReplacementFor_n,Q;scanf("\x25\x64\x20\x25\x64",&
ReplacementFor_n,&Q);for(int ReplacementFor_i=(0x1c2+4535-0x1379);
ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++){scanf(
"\x25\x6c\x6c\x64\x20\x25\x6c\x6c\x64",&ReplacementFor_E[ReplacementFor_i],&S[
ReplacementFor_i]);}for(int ReplacementFor_i=(0x1232+2368-0x1b72);
ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++){for(int ReplacementFor_j=
(0x1214+207-0x12e3);ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++){scanf(
"\x25\x6c\x6c\x64",&ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]);if(
ReplacementFor_i==ReplacementFor_j)ReplacementFor_dist[ReplacementFor_i][
ReplacementFor_j]=(0x1a8c+24-0x1aa4);else if(ReplacementFor_dist[
ReplacementFor_i][ReplacementFor_j]==-(0x2fc+6767-0x1d6a))ReplacementFor_dist[
ReplacementFor_i][ReplacementFor_j]=ReplacementFor_INF;}}for(int 
ReplacementFor_i=(0x1270+3649-0x20b1);ReplacementFor_i<ReplacementFor_n;
ReplacementFor_i++){for(int ReplacementFor_j=(0x180c+1542-0x1e12);
ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++){for(int ReplacementFor_k=
(0x118f+1184-0x162f);ReplacementFor_k<ReplacementFor_n;ReplacementFor_k++){
ReplacementFor_dist[ReplacementFor_j][ReplacementFor_k]=min(ReplacementFor_dist[
ReplacementFor_j][ReplacementFor_k],ReplacementFor_dist[ReplacementFor_j][
ReplacementFor_i]+ReplacementFor_dist[ReplacementFor_i][ReplacementFor_k]);}}}
for(int ReplacementFor_i=(0x1cda+2474-0x2684);ReplacementFor_i<ReplacementFor_n;
ReplacementFor_i++){for(int ReplacementFor_j=(0x18a+5368-0x1682);
ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++){if(ReplacementFor_i==
ReplacementFor_j)ReplacementFor_dp[ReplacementFor_i][ReplacementFor_j]=0.0;else 
if(ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]<=ReplacementFor_E[
ReplacementFor_i])ReplacementFor_dp[ReplacementFor_i][ReplacementFor_j]=(double)
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]/(double)S[
ReplacementFor_i];else ReplacementFor_dp[ReplacementFor_i][ReplacementFor_j]=(
double)ReplacementFor_INF;}}for(int ReplacementFor_i=(0x1273+2862-0x1da1);
ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++){for(int ReplacementFor_j=
(0x8f7+5580-0x1ec3);ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++){for(
int ReplacementFor_k=(0x4aa+4620-0x16b6);ReplacementFor_k<ReplacementFor_n;
ReplacementFor_k++){ReplacementFor_dp[ReplacementFor_j][ReplacementFor_k]=min(
ReplacementFor_dp[ReplacementFor_j][ReplacementFor_k],ReplacementFor_dp[
ReplacementFor_j][ReplacementFor_i]+ReplacementFor_dp[ReplacementFor_i][
ReplacementFor_k]);}}}for(int ReplacementFor_i=(0x14a7+2050-0x1ca9);
ReplacementFor_i<Q;ReplacementFor_i++){if(ReplacementFor_i!=(0xfbf+4290-0x2081))
printf("\x20");int s,ReplacementFor_t;scanf("\x25\x64\x20\x25\x64",&s,&
ReplacementFor_t);s--,ReplacementFor_t--;printf("\x25\x2e\x31\x30\x66",
ReplacementFor_dp[s][ReplacementFor_t]);}puts("");}return(0x10b4+522-0x12be);}
