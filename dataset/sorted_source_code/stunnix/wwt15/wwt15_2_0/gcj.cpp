
#include <bits/stdc++.h>
using namespace std;typedef long long ReplacementFor_ll;typedef double 
ReplacementFor_db;typedef pair<int,int>ReplacementFor_pii;
#define ReplacementFor_eprintf(...) fprintf(stderr,ReplacementFor___VA_ARGS__)
const int ReplacementFor_N=(0x12d9+3723-0x20fb);const int ReplacementFor_inf=int
(1e9)+(0x8c6+5119-0x1cbe);const ReplacementFor_db ReplacementFor_oo=1./
(0x6d8+4579-0x18bb);int ReplacementFor_n,q;int ReplacementFor_E[ReplacementFor_N
],S[ReplacementFor_N];int ReplacementFor_d[ReplacementFor_N][ReplacementFor_N];
ReplacementFor_db ReplacementFor_dist[ReplacementFor_N][ReplacementFor_N];int 
main(){freopen(
"\x43\x2d\x73\x6d\x61\x6c\x6c\x2d\x61\x74\x74\x65\x6d\x70\x74\x30\x2e\x69\x6e",
"\x72",stdin);freopen("\x43\x2e\x6f\x75\x74","\x77",stdout);int ReplacementFor_T
;scanf("\x25\x64",&ReplacementFor_T);for(int Case=(0x8f3+583-0xb39);Case<=
ReplacementFor_T;Case++){scanf("\x25\x64\x25\x64",&ReplacementFor_n,&q);for(int 
ReplacementFor_i=(0x790+4262-0x1835);ReplacementFor_i<=ReplacementFor_n;
ReplacementFor_i++)scanf("\x25\x64\x25\x64",&ReplacementFor_E[ReplacementFor_i],
&S[ReplacementFor_i]);for(int ReplacementFor_i=(0x111c+354-0x127d);
ReplacementFor_i<=ReplacementFor_n;ReplacementFor_i++)for(int ReplacementFor_j=
(0x6e8+1770-0xdd1);ReplacementFor_j<=ReplacementFor_n;ReplacementFor_j++){scanf(
"\x25\x64",&ReplacementFor_d[ReplacementFor_i][ReplacementFor_j]);if(
ReplacementFor_d[ReplacementFor_i][ReplacementFor_j]==-(0x323+2347-0xc4d))
ReplacementFor_d[ReplacementFor_i][ReplacementFor_j]=ReplacementFor_inf;if(
ReplacementFor_i==ReplacementFor_j)ReplacementFor_d[ReplacementFor_i][
ReplacementFor_j]=(0xc81+1715-0x1334);}for(int ReplacementFor_k=
(0x4b1+5354-0x199a);ReplacementFor_k<=ReplacementFor_n;ReplacementFor_k++)for(
int ReplacementFor_i=(0x1aa5+2849-0x25c5);ReplacementFor_i<=ReplacementFor_n;
ReplacementFor_i++)for(int ReplacementFor_j=(0x475+4822-0x174a);ReplacementFor_j
<=ReplacementFor_n;ReplacementFor_j++)ReplacementFor_d[ReplacementFor_i][
ReplacementFor_j]=min(ReplacementFor_d[ReplacementFor_i][ReplacementFor_j],
ReplacementFor_d[ReplacementFor_i][ReplacementFor_k]+ReplacementFor_d[
ReplacementFor_k][ReplacementFor_j]);for(int ReplacementFor_i=(0x3b+6302-0x18d8)
;ReplacementFor_i<=ReplacementFor_n;ReplacementFor_i++)for(int ReplacementFor_j=
(0x1389+1583-0x19b7);ReplacementFor_j<=ReplacementFor_n;ReplacementFor_j++)
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]=ReplacementFor_E[
ReplacementFor_i]>=ReplacementFor_d[ReplacementFor_i][ReplacementFor_j]?(
ReplacementFor_db)ReplacementFor_d[ReplacementFor_i][ReplacementFor_j]/S[
ReplacementFor_i]:ReplacementFor_oo;for(int ReplacementFor_k=
(0x18a2+1470-0x1e5f);ReplacementFor_k<=ReplacementFor_n;ReplacementFor_k++)for(
int ReplacementFor_i=(0x439+7128-0x2010);ReplacementFor_i<=ReplacementFor_n;
ReplacementFor_i++)for(int ReplacementFor_j=(0xb26+256-0xc25);ReplacementFor_j<=
ReplacementFor_n;ReplacementFor_j++)ReplacementFor_dist[ReplacementFor_i][
ReplacementFor_j]=min(ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j],
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_k]+ReplacementFor_dist[
ReplacementFor_k][ReplacementFor_j]);printf(
"\x43\x61\x73\x65\x20\x23\x25\x64\x3a",Case);while(q--){int ReplacementFor_u,
ReplacementFor_v;scanf("\x25\x64\x25\x64",&ReplacementFor_u,&ReplacementFor_v);
printf("\x20\x25\x2e\x31\x30\x6c\x66",ReplacementFor_dist[ReplacementFor_u][
ReplacementFor_v]);}printf("\n");}}
