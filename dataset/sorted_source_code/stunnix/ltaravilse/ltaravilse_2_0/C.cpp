
#include <bits/stdc++.h>
using namespace std;int ReplacementFor_n;long long ReplacementFor_dist[
(0x1d4a+59-0x1d05)][(0x105f+5678-0x260d)];long double ReplacementFor_dist2[
(0x1193+1145-0x158c)][(0x82b+1213-0xc68)];
#define ReplacementFor_INF 1000000000000000LL
vector<pair<long long,long double> >ReplacementFor_horses;void solve(){int q;cin
>>ReplacementFor_n>>q;ReplacementFor_horses.resize(ReplacementFor_n);for(int 
ReplacementFor_i=(0x21ef+250-0x22e9);ReplacementFor_i<ReplacementFor_n;
ReplacementFor_i++){cin>>ReplacementFor_horses[ReplacementFor_i].first>>
ReplacementFor_horses[ReplacementFor_i].second;}for(int ReplacementFor_i=
(0x3da+1788-0xad6);ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++){for(int
 ReplacementFor_j=(0x1a6c+912-0x1dfc);ReplacementFor_j<ReplacementFor_n;
ReplacementFor_j++){long long a;cin>>a;if(a==-(0x5e4+1129-0xa4c)){if(
ReplacementFor_i==ReplacementFor_j){a=(0x52f+4073-0x1518);}else{a=
ReplacementFor_INF;}}ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]=a;}
}for(int ReplacementFor_k=(0x1225+3306-0x1f0f);ReplacementFor_k<ReplacementFor_n
;ReplacementFor_k++){for(int ReplacementFor_i=(0xe4d+1174-0x12e3);
ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++){for(int ReplacementFor_j=
(0x21dc+650-0x2466);ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++){
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]=min(ReplacementFor_dist[
ReplacementFor_i][ReplacementFor_j],ReplacementFor_dist[ReplacementFor_i][
ReplacementFor_k]+ReplacementFor_dist[ReplacementFor_k][ReplacementFor_j]);}}}
for(int ReplacementFor_i=(0x2667+127-0x26e6);ReplacementFor_i<ReplacementFor_n;
ReplacementFor_i++){for(int ReplacementFor_j=(0x191d+1102-0x1d6b);
ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++){ReplacementFor_dist2[
ReplacementFor_i][ReplacementFor_j]=1e12;if(ReplacementFor_dist[ReplacementFor_i
][ReplacementFor_j]<=ReplacementFor_horses[ReplacementFor_i].first){
ReplacementFor_dist2[ReplacementFor_i][ReplacementFor_j]=(long double)
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]/ReplacementFor_horses[
ReplacementFor_i].second;}}}for(int ReplacementFor_k=(0x70+2261-0x945);
ReplacementFor_k<ReplacementFor_n;ReplacementFor_k++){for(int ReplacementFor_i=
(0x1e93+655-0x2122);ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++){for(
int ReplacementFor_j=(0x31b+1200-0x7cb);ReplacementFor_j<ReplacementFor_n;
ReplacementFor_j++){ReplacementFor_dist2[ReplacementFor_i][ReplacementFor_j]=min
(ReplacementFor_dist2[ReplacementFor_i][ReplacementFor_j],ReplacementFor_dist2[
ReplacementFor_i][ReplacementFor_k]+ReplacementFor_dist2[ReplacementFor_k][
ReplacementFor_j]);}}}for(int ReplacementFor_i=(0x184a+2371-0x218d);
ReplacementFor_i<q;ReplacementFor_i++){int a,ReplacementFor_b;cin>>a>>
ReplacementFor_b;printf("\x20\x25\x36\x66",(double)ReplacementFor_dist2[a-
(0x5fb+378-0x774)][ReplacementFor_b-(0x8e4+3283-0x15b6)]);}cout<<endl;}int main(
){int ReplacementFor_casos;cin>>ReplacementFor_casos;for(int 
ReplacementFor_casito=(0xfd4+2652-0x1a2f);ReplacementFor_casito<=
ReplacementFor_casos;ReplacementFor_casito++){printf(
"\x43\x61\x73\x65\x20\x23\x25\x64\x3a",ReplacementFor_casito);solve();}}
