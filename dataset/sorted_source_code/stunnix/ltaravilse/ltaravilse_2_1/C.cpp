
#include <bits/stdc++.h>
using namespace std;int ReplacementFor_n;long long ReplacementFor_dist[
(0x426+2297-0xc9f)][(0x1490+2529-0x1df1)];long double ReplacementFor_dist2[
(0x12c4+4-0x1248)][(0x8af+3241-0x14d8)];
#define ReplacementFor_INF 1000000000000000LL
vector<pair<long long,long double> >ReplacementFor_horses;void solve(){int q;cin
>>ReplacementFor_n>>q;ReplacementFor_horses.resize(ReplacementFor_n);for(int 
ReplacementFor_i=(0x1417+1025-0x1818);ReplacementFor_i<ReplacementFor_n;
ReplacementFor_i++){cin>>ReplacementFor_horses[ReplacementFor_i].first>>
ReplacementFor_horses[ReplacementFor_i].second;}for(int ReplacementFor_i=
(0x74+2432-0x9f4);ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++){for(int 
ReplacementFor_j=(0x14a4+2166-0x1d1a);ReplacementFor_j<ReplacementFor_n;
ReplacementFor_j++){long long a;cin>>a;if(a==-(0x1ec0+82-0x1f11)){if(
ReplacementFor_i==ReplacementFor_j){a=(0xbfc+4672-0x1e3c);}else{a=
ReplacementFor_INF;}}ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]=a;}
}for(int ReplacementFor_k=(0x164d+3637-0x2482);ReplacementFor_k<ReplacementFor_n
;ReplacementFor_k++){for(int ReplacementFor_i=(0x6a7+7398-0x238d);
ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++){for(int ReplacementFor_j=
(0x10d0+1596-0x170c);ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++){
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]=min(ReplacementFor_dist[
ReplacementFor_i][ReplacementFor_j],ReplacementFor_dist[ReplacementFor_i][
ReplacementFor_k]+ReplacementFor_dist[ReplacementFor_k][ReplacementFor_j]);}}}
for(int ReplacementFor_i=(0x19c6+495-0x1bb5);ReplacementFor_i<ReplacementFor_n;
ReplacementFor_i++){for(int ReplacementFor_j=(0x3fb+7705-0x2214);
ReplacementFor_j<ReplacementFor_n;ReplacementFor_j++){ReplacementFor_dist2[
ReplacementFor_i][ReplacementFor_j]=1e12;if(ReplacementFor_dist[ReplacementFor_i
][ReplacementFor_j]<=ReplacementFor_horses[ReplacementFor_i].first){
ReplacementFor_dist2[ReplacementFor_i][ReplacementFor_j]=(long double)
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]/ReplacementFor_horses[
ReplacementFor_i].second;}}}for(int ReplacementFor_k=(0xba7+387-0xd2a);
ReplacementFor_k<ReplacementFor_n;ReplacementFor_k++){for(int ReplacementFor_i=
(0x1220+4415-0x235f);ReplacementFor_i<ReplacementFor_n;ReplacementFor_i++){for(
int ReplacementFor_j=(0x445+191-0x504);ReplacementFor_j<ReplacementFor_n;
ReplacementFor_j++){ReplacementFor_dist2[ReplacementFor_i][ReplacementFor_j]=min
(ReplacementFor_dist2[ReplacementFor_i][ReplacementFor_j],ReplacementFor_dist2[
ReplacementFor_i][ReplacementFor_k]+ReplacementFor_dist2[ReplacementFor_k][
ReplacementFor_j]);}}}for(int ReplacementFor_i=(0x1436+122-0x14b0);
ReplacementFor_i<q;ReplacementFor_i++){int a,ReplacementFor_b;cin>>a>>
ReplacementFor_b;printf("\x20\x25\x36\x66",(double)ReplacementFor_dist2[a-
(0x319+5245-0x1795)][ReplacementFor_b-(0x3e6+3029-0xfba)]);}cout<<endl;}int main
(){int ReplacementFor_casos;cin>>ReplacementFor_casos;for(int 
ReplacementFor_casito=(0x99c+6991-0x24ea);ReplacementFor_casito<=
ReplacementFor_casos;ReplacementFor_casito++){printf(
"\x43\x61\x73\x65\x20\x23\x25\x64\x3a",ReplacementFor_casito);solve();}}
