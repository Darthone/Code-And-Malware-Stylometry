
#pragma warning(disable:4996)
#pragma comment(linker, "/STACK:36777216")
#include <stdio.h>
#include <algorithm>
#include <vector>
#include <string>
#include <memory.h>
using namespace std;const int ReplacementFor_MAX_N=(0x884+6992-0x2354);typedef 
long long ReplacementFor_LL;ReplacementFor_LL ReplacementFor_E[
ReplacementFor_MAX_N];ReplacementFor_LL ReplacementFor_dist[ReplacementFor_MAX_N
][ReplacementFor_MAX_N];double S[ReplacementFor_MAX_N];double 
ReplacementFor_hour[ReplacementFor_MAX_N][ReplacementFor_MAX_N];int main(){
freopen("\x43\x2d\x6c\x61\x72\x67\x65\x2e\x69\x6e","\x72",stdin);freopen(
"\x43\x2d\x6c\x61\x72\x67\x65\x2e\x6f\x75\x74","\x77",stdout);int 
ReplacementFor_T;scanf("\x25\x64",&ReplacementFor_T);while(ReplacementFor_T-- >
(0x1272+5140-0x2686)){int ReplacementFor_N,Q;scanf("\x25\x64\x20\x25\x64",&
ReplacementFor_N,&Q);for(int ReplacementFor_i=(0x8b6+7415-0x25ad);
ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++){scanf(
"\x25\x6c\x6c\x64\x20\x25\x6c\x66",&ReplacementFor_E[ReplacementFor_i],&S[
ReplacementFor_i]);}for(int ReplacementFor_i=(0x612+5277-0x1aaf);
ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++){for(int ReplacementFor_j=
(0xaa9+328-0xbf1);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){scanf(
"\x25\x6c\x6c\x64",&ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]);}}
for(int ReplacementFor_k=(0x85c+6855-0x2323);ReplacementFor_k<ReplacementFor_N;
ReplacementFor_k++){for(int ReplacementFor_i=(0x47f+4459-0x15ea);
ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++)for(int ReplacementFor_j=
(0x9ad+1203-0xe60);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){if(
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_k]<-0.5)continue;if(
ReplacementFor_dist[ReplacementFor_k][ReplacementFor_j]<-0.5)continue;if(
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]<-0.5||
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]>ReplacementFor_dist[
ReplacementFor_i][ReplacementFor_k]+ReplacementFor_dist[ReplacementFor_k][
ReplacementFor_j]){ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]=
ReplacementFor_dist[ReplacementFor_i][ReplacementFor_k]+ReplacementFor_dist[
ReplacementFor_k][ReplacementFor_j];}}}for(int ReplacementFor_i=(0x71f+11-0x72a)
;ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++){for(int ReplacementFor_j=
(0x139b+2514-0x1d6d);ReplacementFor_j<ReplacementFor_N;ReplacementFor_j++){if(
ReplacementFor_i==ReplacementFor_j)ReplacementFor_hour[ReplacementFor_i][
ReplacementFor_j]=0.0;else{ReplacementFor_hour[ReplacementFor_i][
ReplacementFor_j]=-(0x17a5+2547-0x2197);if(ReplacementFor_dist[ReplacementFor_i]
[ReplacementFor_j]>-0.5&&ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]
<=ReplacementFor_E[ReplacementFor_i]){ReplacementFor_hour[ReplacementFor_i][
ReplacementFor_j]=double(ReplacementFor_dist[ReplacementFor_i][ReplacementFor_j]
)/S[ReplacementFor_i];}}}}for(int ReplacementFor_k=(0x131+545-0x352);
ReplacementFor_k<ReplacementFor_N;ReplacementFor_k++){for(int ReplacementFor_i=
(0x350+5269-0x17e5);ReplacementFor_i<ReplacementFor_N;ReplacementFor_i++){for(
int ReplacementFor_j=(0x7b0+1983-0xf6f);ReplacementFor_j<ReplacementFor_N;
ReplacementFor_j++){if(ReplacementFor_hour[ReplacementFor_i][ReplacementFor_k]<-
0.5)continue;if(ReplacementFor_hour[ReplacementFor_k][ReplacementFor_j]<-0.5)
continue;if(ReplacementFor_hour[ReplacementFor_i][ReplacementFor_j]<-0.5||
ReplacementFor_hour[ReplacementFor_i][ReplacementFor_j]>ReplacementFor_hour[
ReplacementFor_i][ReplacementFor_k]+ReplacementFor_hour[ReplacementFor_k][
ReplacementFor_j]){ReplacementFor_hour[ReplacementFor_i][ReplacementFor_j]=
ReplacementFor_hour[ReplacementFor_i][ReplacementFor_k]+ReplacementFor_hour[
ReplacementFor_k][ReplacementFor_j];}}}}static int ReplacementFor_cs=
(0x973+6927-0x2481);printf("\x43\x61\x73\x65\x20\x23\x25\x64\x3a",
ReplacementFor_cs++);for(int ReplacementFor_i=(0x55+1897-0x7be);ReplacementFor_i
<Q;ReplacementFor_i++){int ReplacementFor_u,ReplacementFor_v;scanf(
"\x25\x64\x20\x25\x64",&ReplacementFor_u,&ReplacementFor_v);ReplacementFor_u--;
ReplacementFor_v--;printf("\x20\x25\x2e\x39\x6c\x66",ReplacementFor_hour[
ReplacementFor_u][ReplacementFor_v]);}printf("\n");}return(0xdba+6454-0x26f0);}
